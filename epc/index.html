<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Electronic Parts Catalogue</title>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3C!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--%3E%3Cpath fill='%23fff' opacity='1' d='M430.5 284.4l-31.82-79.54C383.7 177.6 357.7 160 328.4 160H183.6C154.3 160 128.3 177.6 117.4 204.8l-31.82 79.56C62.88 301.1 48 329.2 48 360V480c0 17.67 14.33 32 32 32H96c17.67 0 32-14.33 32-32v-32h288v32c0 17.67 14.33 32 32 32s32-14.33 32-32v-120C464 329.2 449.1 301.1 426.4 284.4zM161.9 222.7C165.5 213.8 174 208 183.6 208h144.8c9.598 0 18.1 5.76 21.66 14.66L366.6 264H145.4L161.9 222.7zM416 400H96v-40c0-26.47 21.53-48 48-48h224c26.47 0 48 21.53 48 48V400zM505.9 111.1H447.8l-21.37-31.1l21.37-31.1h58.14c4.619 0 7.619-5.048 5.246-9.001C497.2 15.66 471.7 0 442.4 0c-32.79 0-60.59 19.86-73.01 48H142.8C131.9 23.19 108.6 4.574 80.9 .7793c-33.87-4.641-64.28 11.89-80.05 38.19c-2.381 3.955 .6094 9.034 5.24 9.034H64.22l21.37 31.1L64.22 112H6.078c-4.619 0-7.619 5.047-5.246 9.002C14.82 144.3 40.33 160 69.57 160c32.79 0 60.59-19.86 73.01-47.1h226.6c10.97 24.81 34.23 43.43 61.94 47.22c33.87 4.641 64.28-11.89 80.05-38.19C513.5 117.1 510.5 111.1 505.9 111.1zM160 336c-13.25 0-24 10.74-24 24C136 373.3 146.7 384 160 384s24-10.75 24-24C184 346.7 173.3 336 160 336zM352 336c-13.25 0-24 10.74-24 24c0 13.25 10.75 24 24 24s24-10.75 24-24C376 346.7 365.3 336 352 336z'/%3E%3Cpath fill='white' opacity='0.4' d='M511.2 121c-15.77 26.3-46.18 42.83-80.05 38.19c-27.7-3.795-50.96-22.41-61.94-47.22H142.6C130.2 140.1 102.4 160 69.57 160C40.33 160 14.82 144.3 .832 121C-1.541 117 1.459 112 6.078 112H64.22l21.37-31.1L64.22 48H6.09c-4.631 0-7.621-5.068-5.24-9.034c15.77-26.3 46.18-42.83 80.05-38.19c27.7 3.795 50.96 22.41 61.94 47.22h226.6C381.8 19.86 409.6 0 442.4 0c29.23 0 54.75 15.66 68.73 38.1c2.373 3.955-.627 9.001-5.246 9.001H447.8l-21.37 31.1l21.37 31.1h58.13C510.5 111.1 513.5 117.1 511.2 121z'/%3E%3C/svg%3E">
<style>
:root { --bg: #f4f4f9; --text: #121212; --brand-card: #fff; --brand-card-hover: #c0dafd; --table-header: #003366; --table-header-text: #fff; --model-hover: #e0f0ff; --selected-model: #c0dafd; --breadcrumb-bg: #e9ecef; --breadcrumb: #003366; --box-shadow: 0 0 8px rgba(0,0,0,0.05); --border: #dee2e6; --test: #6c757d; --text-btn: #6c757d; }
body[data-bs-theme="dark"] { --bg: #212529; --text: #dee2e6; --brand-card: #181818; --brand-card-hover: #334460; --table-header: #52789b; --table-header-text: #eaf1ff; --model-hover: #25344a; --selected-model: #38507c; --breadcrumb-bg: #495057; --breadcrumb: #c7d7ef; --box-shadow: 0 0 8px rgba(0,0,0,0.18); --border: #495057; --test: #ccc; }
body { font-family: Arial, sans-serif; margin: 1rem; background: var(--bg); color: var(--text); transition: background 0.3s, color 0.3s; }
.container { display: flex; gap: 2rem; }
.brand-card { background: var(--brand-card); border-radius: 8px; padding: 1rem; width: 120px; box-shadow: 0 2px 6px rgb(0 0 0 / 0.1); cursor: pointer; text-align: center; transition: background-color 0.25s, box-shadow 0.25s; border: 1px solid var(--border); }
.brand-card:hover { background: var(--brand-card-hover); box-shadow: 0 4px 12px rgb(0 0 0 / 0.15); }
.brand-card.selected { background: var(--selected-model) !important; font-weight: bold; border: 2px solid var(--table-header); }
.brand-logo { width: 50px; height: 50px; margin-bottom: 0.5rem; object-fit: contain; }
/* --- NEW CSS FOR LOGO INVERSION --- */
body[data-bs-theme="dark"] .brand-logo.invert-in-dark {
    filter: invert(1) brightness(1.08);
}



.brand-code, .brand-name { opacity: 1 !important; font-weight: 700; font-size: 1.1rem; transition: none !important; }


/* Set default text color for brand cards */
.brand-code, .brand-name {
  color: #26334d; /* Dark blue for light mode */
}

/* Set lighter text color for brand cards in dark mode */
body[data-bs-theme="dark"] .brand-code,
body[data-bs-theme="dark"] .brand-name {
  color: var(--text); /* Uses your main light text color variable */
}


.brand-name { font-weight: 100; font-size: 0.9rem; }
.back-btn { display: inline-block; padding: 0.6rem 1.4rem; font-size: 1.14rem; font-weight: 600; color: var(--text-btn); background: none; border: 1.5px solid var(--border, #444); border-radius: 8px; text-decoration: none; transition: background 0.18s, color 0.18s, border 0.18s; margin-right: 0.5rem; letter-spacing: 0.01em; }
.back-btn:hover, .back-btn:focus { color: #007bff; border-color: #007bff; text-decoration: none; }
#brands-container, #models-container { flex: 1; background: var(--brand-card); padding: 1rem; border-radius: 6px; box-shadow: var(--box-shadow); border: 1px solid var(--border); }
#models-container { flex: 2; max-height: 500px; overflow-y: auto; }
#brands-list-scroll { max-height: 70vh; overflow-y: auto; padding-right: 4px; }
h2 { margin-top: 0; margin-bottom: 1rem; border-bottom: 2px solid var(--table-header); padding-bottom: 0.3rem; color: var(--text); }
#brands-list { display: flex; gap: 1rem; flex-wrap: wrap; }
table { width: 100%; border-collapse: collapse; }
th, td { text-align: left; padding: 0.5rem 0.75rem; border-bottom: 1px solid var(--border); cursor: pointer; }
th { background-color: var(--table-header); color: var(--table-header-text); font-weight: bold; position: sticky; top: 0; z-index: 2; }
tbody tr:hover { background-color: var(--model-hover); }
.selected-model { background-color: var(--selected-model) !important; font-weight: bold; }
.breadcrumb { display: flex; flex-wrap: wrap; padding: 0.5rem 1rem; list-style: none; background-color: var(--breadcrumb-bg); border-radius: 0.25rem; font-size: 0.9rem; color: var(--breadcrumb); }
.breadcrumb-item + .breadcrumb-item::before { content: "›"; padding: 0 0.5rem; color: #6c757d; }
.breadcrumb-item a { color: var(--breadcrumb); text-decoration: none; cursor: pointer; }
.breadcrumb-item.active { font-weight: 600; }
@media (max-width: 700px) {
  body {
    margin: 0.3rem;
  }
  h1 {
    font-size: 1.35rem;
    margin-bottom: 0.7rem;
  }
  .container {
    flex-direction: column;
    gap: 0.8rem;
  }
  #brands-container, #models-container {
    max-width: 100%;
    border-radius: 0;
    padding: 0.5rem 0.5rem 0.7rem 0.5rem;
    box-shadow: none;
  }
  #brands-list {
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: flex-start;
  }
  .brand-card {
    width: 46vw;
    min-width: 120px;
    max-width: 180px;
    padding: 0.5rem 0.2rem;
    margin-bottom: 0.2rem;
  }
  .brand-logo {
    width: 36px;
    height: 36px;
    margin-bottom: 0.3rem;
  }
  #models-container {
    max-height: none;
    overflow: visible;
    margin-top: 0.3rem;
  }
  table {
    font-size: 0.97rem;
  }
  th, td {
    padding: 0.3rem 0.3rem;
  }
  .breadcrumb {
    padding: 0.35rem 0.7rem;
    font-size: 0.88rem;
    border-radius: 0;
  }
}
/* --- DARK MODE CUSTOM SCROLLBARS --- */
body[data-bs-theme="dark"] ::-webkit-scrollbar {
    width: 12px;
    background: #23272e;
}
body[data-bs-theme="dark"] ::-webkit-scrollbar-thumb {
    background: #3d434e;
    border-radius: 8px;
    border: 2px solid #23272e;
}
body[data-bs-theme="dark"] ::-webkit-scrollbar-thumb:hover {
    background: #596080;
}
body[data-bs-theme="dark"] ::-webkit-scrollbar-corner {
    background: #23272e;
}

/* Firefox (newer versions) */
body[data-bs-theme="dark"] {
    scrollbar-color: #3d434e #23272e;
    scrollbar-width: thin;
}
</style>
</head>
<body>

<div style="display:flex;align-items:center;justify-content:space-between;">
  <h1 style="margin:0;font-size:1.5rem;font-weight:700;">Electronic Parts Catalogue</h1>
  <div style="display:flex;align-items:center;gap:0.7rem;">
    <a href="#" id="epc-home-btn" class="back-btn">‹ Home</a>
    <button id="theme-toggle" title="Toggle light/dark mode" style="background:var(--brand-card);border:1px solid var(--border);border-radius:50%;cursor:pointer;width:40px;height:40px;display:flex;justify-content:center;align-items:center;padding:0 0.5rem;font-size:1.1rem;color:var(--test);">
      <span class="moon-icon">
          
          
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:20px;height:20px;"><path fill="currentColor" d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.64 5.64c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41zm12.72 12.72c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41zM5.64 18.36c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41zM18.36 5.64c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41z"/></svg>
      
      
      
      </span>
      <span class="sun-icon" style="display:none;">
          
          
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:20px;height:20px;fill:currentColor;"><path d="M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
      
      
      
      </span>
    </button>
  </div>
</div>

<nav aria-label="breadcrumb" style="margin-bottom: 1rem;">
  <ol class="breadcrumb" id="breadcrumb"></ol>
</nav>

<div class="container">
  <div id="brands-container">
    <h2>Brands</h2>
    <div id="brands-list-scroll"><div id="brands-list"></div></div>
  </div>
  <div id="models-container">
    <h2>Models</h2>
    <table id="models-table">
      <thead><tr><th>Code</th><th>Name</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {

  // --- UNIVERSAL HELPER FUNCTIONS ---
  function isElectron() { return navigator.userAgent.toLowerCase().indexOf(' electron/') > -1; }
  function getRootPath() { if (window.location.pathname.includes('/epc/')) { return '../'; } return './'; }

  // --- UNIVERSAL THEME LOGIC ---
  function setTheme(theme) { document.body.setAttribute('data-bs-theme', theme); localStorage.setItem('theme', theme); updateThemeIcon(); }
  function updateThemeIcon() {
    document.querySelectorAll('#theme-toggle').forEach(btn => {
      const moon = btn.querySelector('.moon-icon'); const sun = btn.querySelector('.sun-icon'); if (!moon || !sun) return;
      if (document.body.getAttribute('data-bs-theme') === 'dark') { sun.style.display = 'none'; moon.style.display = ''; } else { sun.style.display = ''; moon.style.display = 'none'; }
    });
  }

  // --- PAGE-SPECIFIC LOGIC ---
  function initializeEpcPage() {
    const brandsList = document.getElementById('brands-list');
    const modelsTableBody = document.querySelector('#models-table tbody');
    const breadcrumbEl = document.getElementById('breadcrumb');
    let selectedBrandCard = null;
    const rootPath = getRootPath(); 

    function renderBreadcrumb(selectedBrandCode, selectedBrandName) {
      breadcrumbEl.innerHTML = '';
      const liHome = document.createElement('li');
      liHome.className = 'breadcrumb-item';
      const aHome = document.createElement('a');
      aHome.textContent = 'EPC';
      aHome.href = '#';
      aHome.onclick = e => { e.preventDefault(); clearBrandSelection(); };
      liHome.appendChild(aHome);
      breadcrumbEl.appendChild(liHome);
      if (selectedBrandCode && selectedBrandName) {
        const liBrand = document.createElement('li');
        liBrand.className = 'breadcrumb-item active';
        liBrand.setAttribute('aria-current', 'page');
        liBrand.textContent = `${selectedBrandName}`;
        breadcrumbEl.appendChild(liBrand);
      }
    }

    function clearBrandSelection() {
      if (selectedBrandCard) { selectedBrandCard.classList.remove('selected'); selectedBrandCard = null; }
      modelsTableBody.innerHTML = '<tr><td colspan="2" style="text-align:center; font-style: italic;">Please select a brand to view models.</td></tr>';
      sessionStorage.removeItem('selectedBrand');
      renderBreadcrumb(null, null);
    }

    function selectBrand(code, card) {
      if (selectedBrandCard) selectedBrandCard.classList.remove('selected');
      selectedBrandCard = card;
      card.classList.add('selected');
      sessionStorage.setItem('selectedBrand', code);
      loadModels(code);
      renderBreadcrumb(code, card.querySelector('.brand-name').textContent);
    }

    async function loadModels(brandCode) {
      try {
        const response = await fetch(`${rootPath}data/brands/${brandCode.toLowerCase()}/models.json`);
        if (!response.ok) throw new Error('No models found');
        const data = await response.json();
        modelsTableBody.innerHTML = '';
        const models = data[brandCode.toLowerCase()];
        if (!models || models.length === 0) throw new Error('No models found');
        models.forEach(model => {
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${model.code}</td><td>${model.name}</td>`;
          tr.onclick = () => { window.location.href = `epc.html?brand=${brandCode.toLowerCase()}&model=${model.code}`; };
          modelsTableBody.appendChild(tr);
        });
      } catch (error) { modelsTableBody.innerHTML = '<tr><td colspan="2" style="text-align:center; font-style: italic;">No models available.</td></tr>'; }
    }

    async function loadBrands() {
      try {
        const response = await fetch(`${rootPath}data/brands.json`);
        const brands = await response.json();
        brands.sort((a, b) => a.name.localeCompare(b.name));
        brandsList.innerHTML = '';
        brands.forEach(brand => {
          const card = document.createElement('div');
          card.className = 'brand-card';
          card.dataset.code = brand.code;
          // --- THIS IS THE CORRECTED LINE ---
          const invertClass = brand.invertInDark ? 'invert-in-dark' : '';
          card.innerHTML = `<img src="${brand.logo}" alt="${brand.name} logo" class="brand-logo ${invertClass}" /><div class="brand-code">${brand.code}</div><div class="brand-name">${brand.name}</div>`;
          card.onclick = () => selectBrand(brand.code, card);
          brandsList.appendChild(card);
        });
        const savedBrand = sessionStorage.getItem('selectedBrand');
        if (savedBrand) {
          const brandCard = [...brandsList.children].find(c => c.dataset.code === savedBrand);
          if (brandCard) selectBrand(savedBrand, brandCard);
          else clearBrandSelection();
        } else {
          clearBrandSelection();
        }
      } catch (error) { brandsList.innerHTML = '<p>Error loading brands.</p>'; }
    }

    loadBrands();
  }

  // --- UNIVERSAL MASTER EVENT LISTENER ---
  document.body.addEventListener('click', function(e) {
    const homeLink = e.target.closest('#epc-home-btn');
    const themeToggleButton = e.target.closest('#theme-toggle');

    if (homeLink) {
      e.preventDefault(); const root = getRootPath();
      if (isElectron()) { window.location.href = root + 'app-home.html'; } 
      else { window.location.href = root + 'index.html'; }
    }
    
    if (themeToggleButton) {
      const current = document.body.getAttribute('data-bs-theme');
      setTheme(current === 'dark' ? 'light' : 'dark');
    }
  });
  
  // --- UNIVERSAL PAGE INITIALIZATION ---
  function initializePage() {
    setTheme(localStorage.getItem('theme') || 'dark');
    initializeEpcPage();
  }

  initializePage();
});
</script>

</body>
</html>